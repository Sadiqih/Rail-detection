<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>X-TRAGO Live Stream</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <style>
    html,body{height:100%;margin:0;background:#040916;display:flex;align-items:center;justify-content:center}
    .frame{width:100%;max-width:1200px;border-radius:12px;overflow:hidden;border:4px solid rgba(0,180,255,0.95);box-shadow:0 0 18px rgba(0,180,255,0.75),0 0 40px rgba(0,180,255,0.35)}
    img#stream{width:100%;height:auto;display:block;background:#000}
  </style>
</head>
<body>
  <div class="frame"><img id="stream" src="" alt="Waiting for stream..."></div>

  <script>
    const broker = "wss://f89f938116df4dee81d5215df5ba4782.s1.eu.hivemq.cloud:8884/mqtt";
    const opts = { username: "intelligent", password: "Penem2018", reconnectPeriod: 2000 };
    const client = mqtt.connect(broker, opts);
    const img = document.getElementById("stream");
    client.on("connect", ()=> client.subscribe("detection/image"));
    client.on("message", (topic, message) => {
      if (topic === "detection/image") {
        img.src = "data:image/jpeg;base64," + message.toString();
      }
    });
    client.on("error", (e)=> console.error("MQTT err", e));
  </script>
</body>
</html>
